-module('fn_format_number_SUITE').

-include_lib("common_test/include/ct.hrl").

-export([
    all/0,
    groups/0,
    suite/0
]).

-export([
    init_per_suite/1,
    init_per_group/2,
    end_per_group/2,
    end_per_suite/1
]).

-export(['numberformat01'/1]).
-export(['numberformat02'/1]).
-export(['numberformat03'/1]).
-export(['numberformat04'/1]).
-export(['numberformat05'/1]).
-export(['numberformat06'/1]).
-export(['numberformat07'/1]).
-export(['numberformat08'/1]).
-export(['numberformat09'/1]).
-export(['numberformat11'/1]).
-export(['numberformat12'/1]).
-export(['numberformat13'/1]).
-export(['numberformat14'/1]).
-export(['numberformat15'/1]).
-export(['numberformat16'/1]).
-export(['numberformat17'/1]).
-export(['numberformat18'/1]).
-export(['numberformat19'/1]).
-export(['numberformat20'/1]).
-export(['numberformat26'/1]).
-export(['numberformat27'/1]).
-export(['numberformat28'/1]).
-export(['numberformat29'/1]).
-export(['numberformat30'/1]).
-export(['numberformat31'/1]).
-export(['numberformat32'/1]).
-export(['numberformat34'/1]).
-export(['numberformat35'/1]).
-export(['numberformat36'/1]).
-export(['numberformat37'/1]).
-export(['numberformat38'/1]).
-export(['numberformat39'/1]).
-export(['numberformat40'/1]).
-export(['numberformat41'/1]).
-export(['numberformat42'/1]).
-export(['numberformat60a'/1]).
-export(['numberformat60b'/1]).
-export(['numberformat60c'/1]).
-export(['numberformat60d'/1]).
-export(['numberformat60e'/1]).
-export(['numberformat60f'/1]).
-export(['numberformat60g'/1]).
-export(['numberformat60h'/1]).
-export(['numberformat60i'/1]).
-export(['numberformat60j'/1]).
-export(['numberformat60k'/1]).
-export(['numberformat60l'/1]).
-export(['numberformat60m'/1]).
-export(['numberformat60n'/1]).
-export(['numberformat60o'/1]).
-export(['numberformat60p'/1]).
-export(['numberformat60q'/1]).
-export(['numberformat61'/1]).
-export(['numberformat63'/1]).
-export(['numberformat64'/1]).
-export(['numberformat65'/1]).
-export(['numberformat70'/1]).
-export(['numberformat71'/1]).
-export(['numberformat72'/1]).
-export(['numberformat80'/1]).
-export(['numberformat81'/1]).
-export(['numberformat82'/1]).
-export(['numberformat83'/1]).
-export(['numberformat84'/1]).
-export(['numberformat85'/1]).
-export(['numberformat86'/1]).
-export(['numberformat87'/1]).
-export(['numberformat88'/1]).
-export(['numberformat89'/1]).
-export(['numberformat90'/1]).
-export(['numberformat91'/1]).
-export(['numberformat92'/1]).
-export(['numberformat93'/1]).
-export(['numberformat94'/1]).
-export(['numberformat95'/1]).
-export(['numberformat101'/1]).
-export(['numberformat102'/1]).
-export(['numberformat103'/1]).
-export(['numberformat104'/1]).
-export(['numberformat105'/1]).
-export(['numberformat106'/1]).
-export(['numberformat107'/1]).
-export(['numberformat108'/1]).
-export(['numberformat109'/1]).
-export(['numberformat110'/1]).
-export(['numberformat111'/1]).
-export(['numberformat112'/1]).
-export(['numberformat113'/1]).
-export(['numberformat114'/1]).
-export(['numberformat115'/1]).
-export(['numberformat116'/1]).
-export(['numberformat117'/1]).
-export(['numberformat118'/1]).
-export(['numberformat119'/1]).
-export(['numberformat120'/1]).
-export(['numberformat121'/1]).
-export(['numberformat122'/1]).
-export(['numberformat123'/1]).
-export(['numberformat124'/1]).
-export(['numberformat125'/1]).
-export(['numberformat126'/1]).
-export(['numberformat127'/1]).
-export(['numberformat128'/1]).
-export(['numberformat129'/1]).
-export(['numberformat130'/1]).
-export(['numberformat131'/1]).
-export(['numberformat132'/1]).
-export(['numberformat133'/1]).
-export(['numberformat134'/1]).
-export(['numberformat135'/1]).
-export(['numberformat136'/1]).
-export(['numberformat137'/1]).
-export(['numberformat138'/1]).
-export(['numberformat139'/1]).
-export(['numberformat140'/1]).
-export(['numberformat141'/1]).
-export(['numberformat142'/1]).
-export(['numberformat143'/1]).
-export(['numberformat144'/1]).
-export(['numberformat145'/1]).
-export(['numberformat146'/1]).
-export(['numberformat150'/1]).
-export(['numberformat151'/1]).
-export(['numberformat152'/1]).
-export(['numberformat153'/1]).
-export(['numberformat154'/1]).
-export(['numberformat155'/1]).
-export(['numberformat156'/1]).
-export(['numberformat157'/1]).
-export(['numberformat158'/1]).
-export(['numberformat201'/1]).
-export(['numberformat202'/1]).
-export(['numberformat203'/1]).
-export(['numberformat204'/1]).
-export(['numberformat205'/1]).
-export(['numberformat206'/1]).
-export(['numberformat207'/1]).
-export(['numberformat208'/1]).
-export(['numberformat209'/1]).
-export(['numberformat210'/1]).
-export(['numberformat211'/1]).
-export(['numberformat212'/1]).
-export(['numberformat213'/1]).
-export(['numberformat214'/1]).
-export(['numberformat215'/1]).
-export(['numberformat216'/1]).
-export(['numberformat217'/1]).
-export(['numberformat218'/1]).
-export(['numberformat219'/1]).
-export(['numberformat220'/1]).
-export(['numberformat221'/1]).
-export(['numberformat222'/1]).
-export(['numberformat223'/1]).
-export(['numberformat224'/1]).
-export(['numberformat225'/1]).
-export(['numberformat226'/1]).
-export(['numberformat227'/1]).
-export(['numberformat228'/1]).
-export(['numberformat229'/1]).
-export(['numberformat230'/1]).
-export(['numberformat231'/1]).
-export(['numberformat232'/1]).
-export(['numberformat233'/1]).
-export(['numberformat234'/1]).
-export(['numberformat235'/1]).
-export(['numberformat236'/1]).
-export(['numberformat237'/1]).
-export(['numberformat238'/1]).
-export(['numberformat239'/1]).
-export(['numberformat240'/1]).
-export(['numberformat241'/1]).
-export(['numberformat242'/1]).
-export(['numberformat243'/1]).
-export(['numberformat244'/1]).
-export(['numberformat245'/1]).
-export(['numberformat246'/1]).
-export(['numberformat247'/1]).
-export(['numberformat248'/1]).
-export(['numberformat249'/1]).
-export(['numberformat250'/1]).
-export(['numberformat251'/1]).
-export(['numberformat252'/1]).
-export(['numberformat253'/1]).
-export(['numberformat254'/1]).
-export(['numberformat255'/1]).
-export(['numberformat261'/1]).
-export(['numberformat262'/1]).
-export(['numberformat263'/1]).
-export(['numberformat301'/1]).
-export(['numberformat302'/1]).
-export(['numberformat303'/1]).
-export(['numberformat304'/1]).
-export(['numberformat310'/1]).
-export(['numberformat311'/1]).
-export(['numberformat312'/1]).
-export(['numberformat313'/1]).
-export(['numberformat314'/1]).
-export(['numberformat315'/1]).
-export(['numberformat316'/1]).
-export(['numberformat317'/1]).
-export(['numberformat318'/1]).
-export(['numberformat319'/1]).
-export(['numberformat901err'/1]).
-export(['numberformat902err'/1]).
-export(['numberformat905err'/1]).
-export(['numberformat906InputErr'/1]).
-export(['numberformat907InputErr'/1]).
-export(['numberformatFODF1280'/1]).
-export(['numberformatNaN'/1]).
-export(['cbcl-fn-format-number-001'/1]).
-export(['cbcl-fn-format-number-002'/1]).
-export(['cbcl-fn-format-number-003'/1]).
-export(['cbcl-fn-format-number-004'/1]).
-export(['cbcl-fn-format-number-005'/1]).
-export(['cbcl-fn-format-number-006'/1]).
-export(['cbcl-fn-format-number-007'/1]).
-export(['cbcl-fn-format-number-008'/1]).
-export(['cbcl-fn-format-number-009'/1]).
-export(['cbcl-fn-format-number-010'/1]).
-export(['cbcl-fn-format-number-011'/1]).
-export(['cbcl-fn-format-number-012'/1]).
-export(['cbcl-fn-format-number-013'/1]).
-export(['cbcl-fn-format-number-014'/1]).
-export(['cbcl-fn-format-number-015'/1]).
-export(['cbcl-fn-format-number-016'/1]).
-export(['cbcl-fn-format-number-017'/1]).
-export(['cbcl-fn-format-number-018'/1]).
-export(['cbcl-fn-format-number-019'/1]).
-export(['cbcl-fn-format-number-020'/1]).
-export(['cbcl-fn-format-number-021'/1]).
-export(['cbcl-fn-format-number-022'/1]).
-export(['cbcl-fn-format-number-023'/1]).
-export(['cbcl-fn-format-number-024'/1]).
-export(['cbcl-fn-format-number-025'/1]).
-export(['cbcl-fn-format-number-026'/1]).
-export(['cbcl-fn-format-number-027'/1]).
-export(['cbcl-fn-format-number-028'/1]).
-export(['cbcl-fn-format-number-029'/1]).
-export(['cbcl-fn-format-number-030'/1]).
-export(['cbcl-fn-format-number-031'/1]).
-export(['cbcl-fn-format-number-032'/1]).
-export(['cbcl-fn-format-number-033'/1]).
-export(['cbcl-fn-format-number-034'/1]).
-export(['cbcl-fn-format-number-035'/1]).
-export(['cbcl-fn-format-number-036'/1]).
-export(['cbcl-fn-format-number-037'/1]).
-export(['cbcl-fn-format-number-038'/1]).
-export(['cbcl-fn-format-number-039'/1]).
-export(['cbcl-fn-format-number-040'/1]).
-export(['cbcl-fn-format-number-041'/1]).
-export(['cbcl-fn-format-number-042'/1]).
-export(['cbcl-fn-format-number-043'/1]).
-export(['cbcl-fn-format-number-044'/1]).
-export(['cbcl-fn-format-number-045'/1]).
-export(['cbcl-fn-format-number-046'/1]).
-export(['cbcl-fn-format-number-047'/1]).
-export(['cbcl-fn-format-number-048'/1]).
-export(['cbcl-fn-format-number-049'/1]).
-export(['cbcl-fn-format-number-050'/1]).
-export(['cbcl-fn-format-number-051'/1]).
-export(['cbcl-fn-format-number-052'/1]).

suite() -> [{timetrap, {seconds, 180}}].

init_per_group(_, Config) -> Config.

end_per_group(_, _Config) ->
    xqerl_code_server:unload(all).

end_per_suite(_Config) ->
    ct:timetrap({seconds, 60}),
    xqerl_code_server:unload(all).

init_per_suite(Config) ->
    {ok, _} = application:ensure_all_started(xqerl),
    DD = filename:dirname(filename:dirname(filename:dirname(?config(data_dir, Config)))),
    TD = filename:join(DD, "QT3-test-suite"),
    __BaseDir = filename:join(TD, "fn"),
    [{base_dir, __BaseDir} | Config].

all() ->
    [
        {group, group_0},
        {group, group_1},
        {group, group_2},
        {group, group_3},
        {group, group_4},
        {group, group_5},
        {group, group_6},
        {group, group_7},
        {group, group_8},
        {group, group_9},
        {group, group_10}
    ].

groups() ->
    [
        {group_0, [parallel], [
            'numberformat01',
            'numberformat02',
            'numberformat03',
            'numberformat04',
            'numberformat05',
            'numberformat06',
            'numberformat07',
            'numberformat08',
            'numberformat09',
            'numberformat11',
            'numberformat12',
            'numberformat13',
            'numberformat14',
            'numberformat15',
            'numberformat16',
            'numberformat17',
            'numberformat18',
            'numberformat19',
            'numberformat20',
            'numberformat26',
            'numberformat27',
            'numberformat28',
            'numberformat29'
        ]},
        {group_1, [parallel], [
            'numberformat30',
            'numberformat31',
            'numberformat32',
            'numberformat34',
            'numberformat35',
            'numberformat36',
            'numberformat37',
            'numberformat38',
            'numberformat39',
            'numberformat40',
            'numberformat41',
            'numberformat42',
            'numberformat60a',
            'numberformat60b',
            'numberformat60c',
            'numberformat60d',
            'numberformat60e',
            'numberformat60f',
            'numberformat60g',
            'numberformat60h',
            'numberformat60i',
            'numberformat60j',
            'numberformat60k',
            'numberformat60l'
        ]},
        {group_2, [parallel], [
            'numberformat60m',
            'numberformat60n',
            'numberformat60o',
            'numberformat60p',
            'numberformat60q',
            'numberformat61',
            'numberformat63',
            'numberformat64',
            'numberformat65',
            'numberformat70',
            'numberformat71',
            'numberformat72',
            'numberformat80',
            'numberformat81',
            'numberformat82',
            'numberformat83',
            'numberformat84',
            'numberformat85',
            'numberformat86',
            'numberformat87',
            'numberformat88',
            'numberformat89',
            'numberformat90',
            'numberformat91'
        ]},
        {group_3, [parallel], [
            'numberformat92',
            'numberformat93',
            'numberformat94',
            'numberformat95',
            'numberformat101',
            'numberformat102',
            'numberformat103',
            'numberformat104',
            'numberformat105',
            'numberformat106',
            'numberformat107',
            'numberformat108',
            'numberformat109',
            'numberformat110',
            'numberformat111',
            'numberformat112',
            'numberformat113',
            'numberformat114',
            'numberformat115',
            'numberformat116',
            'numberformat117',
            'numberformat118',
            'numberformat119',
            'numberformat120'
        ]},
        {group_4, [parallel], [
            'numberformat121',
            'numberformat122',
            'numberformat123',
            'numberformat124',
            'numberformat125',
            'numberformat126',
            'numberformat127',
            'numberformat128',
            'numberformat129',
            'numberformat130',
            'numberformat131',
            'numberformat132',
            'numberformat133',
            'numberformat134',
            'numberformat135',
            'numberformat136',
            'numberformat137',
            'numberformat138',
            'numberformat139',
            'numberformat140',
            'numberformat141',
            'numberformat142',
            'numberformat143',
            'numberformat144'
        ]},
        {group_5, [parallel], [
            'numberformat145',
            'numberformat146',
            'numberformat150',
            'numberformat151',
            'numberformat152',
            'numberformat153',
            'numberformat154',
            'numberformat155',
            'numberformat156',
            'numberformat157',
            'numberformat158',
            'numberformat201',
            'numberformat202',
            'numberformat203',
            'numberformat204',
            'numberformat205',
            'numberformat206',
            'numberformat207',
            'numberformat208',
            'numberformat209',
            'numberformat210',
            'numberformat211',
            'numberformat212',
            'numberformat213'
        ]},
        {group_6, [parallel], [
            'numberformat214',
            'numberformat215',
            'numberformat216',
            'numberformat217',
            'numberformat218',
            'numberformat219',
            'numberformat220',
            'numberformat221',
            'numberformat222',
            'numberformat223',
            'numberformat224',
            'numberformat225',
            'numberformat226',
            'numberformat227',
            'numberformat228',
            'numberformat229',
            'numberformat230',
            'numberformat231',
            'numberformat232',
            'numberformat233',
            'numberformat234',
            'numberformat235',
            'numberformat236',
            'numberformat237'
        ]},
        {group_7, [parallel], [
            'numberformat238',
            'numberformat239',
            'numberformat240',
            'numberformat241',
            'numberformat242',
            'numberformat243',
            'numberformat244',
            'numberformat245',
            'numberformat246',
            'numberformat247',
            'numberformat248',
            'numberformat249',
            'numberformat250',
            'numberformat251',
            'numberformat252',
            'numberformat253',
            'numberformat254',
            'numberformat255',
            'numberformat261',
            'numberformat262',
            'numberformat263',
            'numberformat301',
            'numberformat302',
            'numberformat303'
        ]},
        {group_8, [parallel], [
            'numberformat304',
            'numberformat310',
            'numberformat311',
            'numberformat312',
            'numberformat313',
            'numberformat314',
            'numberformat315',
            'numberformat316',
            'numberformat317',
            'numberformat318',
            'numberformat319',
            'numberformat901err',
            'numberformat902err',
            'numberformat905err',
            'numberformat906InputErr',
            'numberformat907InputErr',
            'numberformatFODF1280',
            'numberformatNaN',
            'cbcl-fn-format-number-001',
            'cbcl-fn-format-number-002',
            'cbcl-fn-format-number-003',
            'cbcl-fn-format-number-004',
            'cbcl-fn-format-number-005',
            'cbcl-fn-format-number-006'
        ]},
        {group_9, [parallel], [
            'cbcl-fn-format-number-007',
            'cbcl-fn-format-number-008',
            'cbcl-fn-format-number-009',
            'cbcl-fn-format-number-010',
            'cbcl-fn-format-number-011',
            'cbcl-fn-format-number-012',
            'cbcl-fn-format-number-013',
            'cbcl-fn-format-number-014',
            'cbcl-fn-format-number-015',
            'cbcl-fn-format-number-016',
            'cbcl-fn-format-number-017',
            'cbcl-fn-format-number-018',
            'cbcl-fn-format-number-019',
            'cbcl-fn-format-number-020',
            'cbcl-fn-format-number-021',
            'cbcl-fn-format-number-022',
            'cbcl-fn-format-number-023',
            'cbcl-fn-format-number-024',
            'cbcl-fn-format-number-025',
            'cbcl-fn-format-number-026',
            'cbcl-fn-format-number-027',
            'cbcl-fn-format-number-028',
            'cbcl-fn-format-number-029',
            'cbcl-fn-format-number-030'
        ]},
        {group_10, [parallel], [
            'cbcl-fn-format-number-031',
            'cbcl-fn-format-number-032',
            'cbcl-fn-format-number-033',
            'cbcl-fn-format-number-034',
            'cbcl-fn-format-number-035',
            'cbcl-fn-format-number-036',
            'cbcl-fn-format-number-037',
            'cbcl-fn-format-number-038',
            'cbcl-fn-format-number-039',
            'cbcl-fn-format-number-040',
            'cbcl-fn-format-number-041',
            'cbcl-fn-format-number-042',
            'cbcl-fn-format-number-043',
            'cbcl-fn-format-number-044',
            'cbcl-fn-format-number-045',
            'cbcl-fn-format-number-046',
            'cbcl-fn-format-number-047',
            'cbcl-fn-format-number-048',
            'cbcl-fn-format-number-049',
            'cbcl-fn-format-number-050',
            'cbcl-fn-format-number-051',
            'cbcl-fn-format-number-052'
        ]}
    ].

'numberformat01'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(2392.14*36.58,'000,000.000000')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat01.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "087,504.481200") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat02'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(12792.14*96.58,'##,###,000.000###')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat02.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1,235,464.8812") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat03'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(2792.14*(-36.58),'000,000.000###')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat03.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-102,136.4812") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat04'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(2392.14*(-36.58),'000,000.000###;###,###.000###')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat04.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "87,504.4812") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat05'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(0.4857,'###.###%')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat05.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "48.57%") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat06'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(0.4857,'###.###‰')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat06.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "485.7‰") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat07'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(95.4857,'¤###.####')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat07.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "¤95.4857") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat08'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(2.14*86.58,'PREFIX##00.000###SUFFIX')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat08.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "PREFIX185.2812SUFFIX") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat09'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(931.4857,'000.000|###')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"", [
                {'decimal-separator', "|"},
                {'grouping-separator', "."}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat09.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "000.931|486") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat11'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(26931.4,'+!!!,!!!.!!!\\-!!,!!!.!!!')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"", [
                {'digit', "!"},
                {'pattern-separator', "\\"}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat11.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "+26,931.4") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat12'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-26931.4,'+!!,!!!.!!!\\-!!!,!!!.!!!')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"", [
                {'digit', "!"},
                {'pattern-separator', "\\"}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat12.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-26,931.4") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat13'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-26931.4,'!!!,!!!.!!!')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"", [
                {'digit', "!"},
                {'pattern-separator', "\\"}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat13.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-26,931.4") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat14'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1 div 0e0,'###############################')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'infinity', "off-the-scale"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat14.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "off-the-scale") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat15'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    {skip, "feature:xpath-1.0-compatibility, spec:XP30+"}.

'numberformat16'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(0.4857,'###.###m')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'per-mille', "m"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat16.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "485.7m") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat17'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-26931.4,'+###,###.###;-###,###.###')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'minus-sign', "_"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat17.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-26,931.4") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat18'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-26931.4,'###,###.###')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'minus-sign', "_"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat18.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "_26,931.4") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat19'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "concat(format-number(-26931.4,'###,###.###','myminus'), '/',\n"
        "            format-number(-42857.1,'###,###.###'))",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"myminus", [{'minus-sign', "_"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat19.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "_26,931.4/-42,857.1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat20'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1234.567,'#*###*###!###','foo:decimal1')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"Q{http://foo.ns}decimal1", [
                {'decimal-separator', "!"},
                {'grouping-separator', "*"}
            ]},
            {"decimal1", [
                {'decimal-separator', "*"},
                {'grouping-separator', "!"}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, [{"http://foo.ns", "foo"}]},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat20.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1*234!567") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat26'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(7654321.4857,'### ### ###,#####')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"", [
                {'decimal-separator', ","},
                {'grouping-separator', " "}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat26.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "7 654 321,4857") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat27'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "string-join((format-number(2392.14*36.58,'000,000.000000','myminus'),\n"
        "                        format-number(2392.14*36.58,'000,000.000000;###,###.000###'),\n"
        "                        format-number(2392.14*36.58,'000,000.000000;###,###.000###','myminus')), ' ')\n"
        "      ",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"myminus", [{'minus-sign', "_"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat27.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "087,504.481200 087,504.481200 087,504.481200") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat28'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(2392.14*(-36.58),'000,000.000###;-###,###.000###')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat28.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-87,504.4812") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat29'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-26931.4,'+###,###.###;_###,###.###')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'minus-sign', "_"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat29.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "_26,931.4") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat30'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "string-join((\n"
        "                format-number(-26931.4,'-###,###.###'),\n"
        "                format-number(-26931.4,'zzz-###,###.###','myminus'),\n"
        "                format-number(-26931.4,'_###,###.###','myminus')), ' ')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"myminus", [{'minus-sign', "_"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat30.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "--26,931.4 _zzz-26,931.4 __26,931.4") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat31'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-26931.4,'###,###.###;###,###.###')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'minus-sign', "_"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat31.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "26,931.4") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat32'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(0.4857,'###.###c')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'percent', "c"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat32.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "48.57c") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat34'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(4030201.0506,'#!!!,!!!,٠٠٠.٠٠٠٠٠٠0')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"", [
                {'digit', "!"},
                {'zero-digit', "٠"}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat34.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "#٤,٠٣٠,٢٠١.٠٥٠٦٠٠0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat35'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(987654321,'###,##0,00.00')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat35.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "9876,543,21.00") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat36'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(239236.588,'00000.00')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat36.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "239236.59") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat37'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1 div 0e0,'###############################')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat37.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "Infinity") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat38'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    {skip, "feature:xpath-1.0-compatibility, spec:XP30+"}.

'numberformat39'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-1 div 0e0,'###############################')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat39.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-Infinity") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat40'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-1 div 0e0,'###############################')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'infinity', "huge"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat40.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-huge") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat41'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    {skip, "feature:xpath-1.0-compatibility, spec:XP30+"}.

'numberformat42'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    {skip, "feature:xpath-1.0-compatibility, spec:XP30+"}.

'numberformat60a'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E25,'#,######')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60a.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "10,000000,000000,000000,000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60b'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E10,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60b.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "10000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60c'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E11,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60c.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "100000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60d'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E12,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60d.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60e'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E13,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60e.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "10000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60f'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E14,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60f.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "100000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60g'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E15,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60g.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1000000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60h'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E16,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60h.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "10000000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60i'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E17,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60i.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "100000000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60j'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E18,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60j.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1000000000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60k'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E19,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60k.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "10000000000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60l'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E20,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60l.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "100000000000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60m'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E25,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60m.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "10000000000000000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60n'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E30,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60n.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1000000000000000000000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60o'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E35,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60o.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "100000000000000000000000000000000000") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60p'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E100,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60p.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case
            xqerl_test:assert_string_value(
                Res,
                "10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
            )
        of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat60q'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1E100 div 3,'#####################')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat60q.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case
            xqerl_test:assert_string_value(
                Res,
                "3333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
            )
        of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat61'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number((),'###.###')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat61.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "NaN") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat63'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "format-number(000123456789012345678901234567890.123456789012345678900000,     '##0.0####################################################')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat63.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case
            lists:any(
                fun
                    ({comment, _}) -> true;
                    (_) -> false
                end,
                [
                    case
                        xqerl_test:assert_string_value(
                            Res,
                            "123456789012345678901234567890.1234567890123456789"
                        )
                    of
                        true -> {comment, "String correct"};
                        {false, F} -> F
                    end,
                    case xqerl_test:assert_error(Res, "FOAR0002") of
                        true -> {comment, "Correct error"};
                        {true, F} -> {comment, "WE: FOAR0002 " ++ binary_to_list(F)};
                        {false, F} -> F
                    end
                ]
            )
        of
            true -> {comment, "any-of"};
            _ -> false
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat64'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "format-number(000123456789012345678901234567890123456789012345678900000,     '# #0.0####################################################')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'grouping-separator', " "}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat64.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case
            lists:any(
                fun
                    ({comment, _}) -> true;
                    (_) -> false
                end,
                [
                    case
                        xqerl_test:assert_string_value(
                            Res,
                            "12 34 56 78 90 12 34 56 78 90 12 34 56 78 90 12 34 56 78 90 12 34 56 78 90 00 00.0"
                        )
                    of
                        true -> {comment, "String correct"};
                        {false, F} -> F
                    end,
                    case xqerl_test:assert_error(Res, "FOAR0002") of
                        true -> {comment, "Correct error"};
                        {true, F} -> {comment, "WE: FOAR0002 " ++ binary_to_list(F)};
                        {false, F} -> F
                    end
                ]
            )
        of
            true -> {comment, "any-of"};
            _ -> false
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat65'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "concat(format-number(1234e0, '0000.####'), '|',\n"
        "                    format-number(1234.00, '0000.####'))",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'grouping-separator', " "}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat65.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1234|1234") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat70'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1234567890.123456,'𚶱000𚶰000')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"", [
                {'decimal-separator', "𚶰"},
                {'grouping-separator', "𚶱"}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat70.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1𚶱234𚶱567𚶱890𚶰123") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat71'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1234567890.123456,'##########𐒠.𐒠#####')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'zero-digit', "𐒠"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat71.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "𐒡𐒢𐒣𐒤𐒥𐒦𐒧𐒨𐒩𐒠.𐒡𐒢𐒣𐒤𐒥𐒦") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat72'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1234567890.123456,'000.000')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat72.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1234567890.123") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat80'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(12.34, '##.##')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat80.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12.34") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat81'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(12.34, '0.000,00', ' b:test ')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"Q{http://a.ns/}test", [
                {'decimal-separator', ","},
                {'grouping-separator', "."}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, [
            {"http://a.ns/", "a"},
            {"http://a.ns/", "b"}
        ]},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat81.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.012,34") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat82'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "format-number(12.34, '0.000,00', if (current-date() gt xs:date('1900-01-01')) then 'two' else 'one')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"one", [
                {'decimal-separator', "."},
                {'grouping-separator', ","}
            ]},
            {"two", [
                {'decimal-separator', ","},
                {'grouping-separator', "."}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat82.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.012,34") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat83'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "format-number(12.34, '0.000,00', concat(if (current-date() lt xs:date('1900-01-01')) then ' a' else ' b', ':one '))",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"Q{http://a.ns/}one", [
                {'decimal-separator', "."},
                {'grouping-separator', ","}
            ]},
            {"Q{http://b.ns/}one", [
                {'decimal-separator', ","},
                {'grouping-separator', "."}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, [
            {"http://a.ns/", "a"},
            {"http://b.ns/", "b"}
        ]},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat83.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.012,34") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat84'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(123456789.34, '#,###.##')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat84.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "123,456,789.34") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat85'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "string-join((\n"
        "                format-number(0, '#'),\n"
        "                format-number(0.0, '#'),\n"
        "                format-number(0.0e0, '#'),\n"
        "                format-number(xs:float(0), '#')), '|')\n"
        "        \n"
        "      ",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat85.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0|0|0|0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat86'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(0.4857,'###.###%', ())",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat86.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "48.57%") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat87'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(12.34, '0.000,00', 'Q{http://a.ns/}test ')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"Q{http://a.ns/}test", [
                {'decimal-separator', ","},
                {'grouping-separator', "."}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat87.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.012,34") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat88'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "format-number(12.34, '0.000,00', if (current-date() lt xs:date('1900-01-01')) then () else ' Q{http://a.ns/}test')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"Q{http://a.ns/}test", [
                {'decimal-separator', ","},
                {'grouping-separator', "."}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat88.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.012,34") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat89'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(12.34, '9,999.99')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat89.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0,012.34") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat90'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(12.34, '#,##9.99')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat90.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12.34") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat91'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(42, '001')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat91.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "042") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat92'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '9.')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat92.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12346") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat93'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.000, '99999.')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat93.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12345") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat94'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '.9')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat94.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12345.7") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat95'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat95.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat101'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(12345.678, '9.9999e999')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat101.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2346e004") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat102'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(12345.678, '9.9999E999')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat102.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat103'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare default decimal-format exponent-separator=\"E\";\n"
        "      let $x := fn:format-number(12345.678, '9.9999E999')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat103.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2346E004") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat104'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare default decimal-format exponent-separator=\"E\";\n"
        "      let $x := fn:format-number(12345.678, '9.9999e999')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat104.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat105'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare decimal-format exp-E exponent-separator=\"E\";\n"
        "      let $x := fn:format-number(12345.678, '9.9999E999', 'exp-E')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat105.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2346E004") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat106'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare decimal-format exp-e exponent-separator=\"e\";\n"
        "      let $x := fn:format-number(12345.678, '9.9999E999', 'exp-e')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat106.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat107'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      let $x := fn:format-number(12345.678, '9.9999E999', 'BadFormat')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat107.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1280") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1280 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat108'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      let $x := fn:format-number(12345.678, '9.99e99e99')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat108.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat109'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare decimal-format exp-bizarre exponent-separator=\"✐\";\n"
        "      let $x := fn:format-number(12345.678, '9.9999✐999', 'exp-bizarre')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat109.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2346✐004") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat110'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      let $x := fn:format-number(12345.678, '9.9999e999%')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat110.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat111'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare decimal-format exp-p exponent-separator=\"%\";\n"
        "      let $x := fn:format-number(12345.678, '9.9999%999', 'exp-p')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat111.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "XQST0098") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: XQST0098 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat112'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare decimal-format exp-p percent=\"!\" exponent-separator=\"%\";\n"
        "      let $x := fn:format-number(12345.678, '9.9999%999', 'exp-p')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat112.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2346%004") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat113'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      let $x := fn:format-number(12345.678, '9.9999eDog')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat113.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12345.6780eDog") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat114'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      let $x := fn:format-number(12345.678, '9.9999e,')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat114.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat115'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      let $x := fn:format-number(12345, '9.9999e99')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat115.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2345e04") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat116'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      let $x := fn:format-number(5, '9.9999e99')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat116.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "5.0000e00") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat117'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      let $x := fn:format-number(.05, '9.9999e99')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat117.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "5.0000e-02") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat118'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      let $x := fn:format-number(123.45E7, '9.9999e99')\n"
        "      return $x\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat118.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2345e09") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat119'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.900001000020000345, '9.99999999999999999e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat119.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "9.00001000020000345e-01") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat120'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(123456789012345678, '9.99999999999999999e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat120.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.23456789012345678e17") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat121'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare function local:timesTenToThe($n as xs:decimal, $exp as xs:integer) as xs:decimal {\n"
        "        if ($exp eq 0)\n"
        "          then $n\n"
        "        else if ($exp gt 0)\n"
        "          then ($n*10) => local:timesTenToThe($exp - 1)\n"
        "        else \n"
        "          ($n div 10) => local:timesTenToThe($exp + 1)  \n"
        "      };    \n"
        "      fn:format-number(1 => local:timesTenToThe(5000), '9.9999e9999')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat121.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case
            lists:any(
                fun
                    ({comment, _}) -> true;
                    (_) -> false
                end,
                [
                    case xqerl_test:assert_string_value(Res, "1.0000e5000") of
                        true -> {comment, "String correct"};
                        {false, F} -> F
                    end,
                    case xqerl_test:assert_error(Res, "FOAR0002") of
                        true -> {comment, "Correct error"};
                        {true, F} -> {comment, "WE: FOAR0002 " ++ binary_to_list(F)};
                        {false, F} -> F
                    end
                ]
            )
        of
            true -> {comment, "any-of"};
            _ -> false
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat122'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare function local:timesTenToThe($n as xs:decimal, $exp as xs:integer) as xs:decimal {\n"
        "        if ($exp eq 0)\n"
        "          then $n\n"
        "        else if ($exp gt 0)\n"
        "          then ($n*10) => local:timesTenToThe($exp - 1)\n"
        "        else \n"
        "          ($n div 10) => local:timesTenToThe($exp + 1)  \n"
        "      };    \n"
        "      fn:format-number(1 => local:timesTenToThe(-5000), '0.0000e0001')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat122.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case
            lists:any(
                fun
                    ({comment, _}) -> true;
                    (_) -> false
                end,
                [
                    case xqerl_test:assert_string_value(Res, "1.0000e-5000") of
                        true -> {comment, "String correct"};
                        {false, F} -> F
                    end,
                    case xqerl_test:assert_string_value(Res, "0.0000e0000") of
                        true -> {comment, "String correct"};
                        {false, F} -> F
                    end
                ]
            )
        of
            true -> {comment, "any-of"};
            _ -> false
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat123'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1.0,'𐒠.𐒠e𐒠')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'zero-digit', "𐒠"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat123.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "𐒡.𐒠e𐒠") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat124'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare decimal-format exp-E exponent-separator=\"x10^\";\n"
        "      fn:format-number(12345.678, '9.9999x10^999', 'exp-E')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat124.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "XQST0097") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: XQST0097 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat125'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare decimal-format exp-E exponent-separator=\"e\" exponent-separator=\"E\";\n"
        "      fn:format-number(12345.678, '9.9999E999', 'exp-E')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat125.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "XQST0114") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: XQST0114 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat126'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare decimal-format exp-E exponent-separator=\"#\";\n"
        "      fn:format-number(12345.678, '9.9999#999', 'exp-E')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat126.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "XQST0098") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: XQST0098 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat127'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    {skip, "spec:XQ30"}.

'numberformat128'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    {skip, "spec:XQ30 XP30"}.

'numberformat129'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '999.99e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat129.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "123.46e02") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat130'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '#99.99e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat130.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12.35e03") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat131'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '#.99e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat131.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.12e05") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat132'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0045.234, '#.#e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat132.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.5e02") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat133'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '.#e9')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat133.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat134'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '.999e9')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat134.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".200e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat135'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '#.e9')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat135.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat136'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '9e9')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat136.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "2e-1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat137'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '999.e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat137.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "123e02") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat138'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '999e9')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat138.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "123e2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat139'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '.e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat139.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat140'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(-12345.678, '999.99e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat140.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-123.46e02") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat141'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.00012345678, '9.99e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat141.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.23e-04") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat142'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(-0.00012345678, '9.99e99')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat142.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-1.23e-04") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat143'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '9.9999e99end')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat143.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2346e04end") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat144'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '9.9999e99e')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat144.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2346e04e") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat145'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '9.9999e99dog')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat145.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2346e04dog") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat146'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, 'end9.9999e99end')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat146.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "end1.2346e04end") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat150'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '#,.##')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat150.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat151'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '#.,##')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat151.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat152'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '#,')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat152.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat153'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '#,,###')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat153.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat154'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare default decimal-format zero-digit = \"٠\";\n"
        "      format-number(1, '٠')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat154.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "١") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat155'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      declare default decimal-format zero-digit = \"٠\";\n"
        "      format-number(1, '٠')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat155.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "١") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat156'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.678, '#.#,,#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat156.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat157'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.6789012345, '#.#,##,#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat157.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12345.6,78,9") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat158'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(12345.6789012345, '#.##,##,##')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat158.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12345.67,89,01") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat201'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat201.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat202'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat202.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat203'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat203.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat204'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat204.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat205'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat205.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat206'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat206.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat207'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '.0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat207.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat208'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '.0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat208.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat209'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '#.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat209.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat210'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '#.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat210.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat211'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '0.0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat211.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat212'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '0.0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat212.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat213'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '0.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat213.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat214'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '0.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat214.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat215'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '#.0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat215.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat216'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '#.0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat216.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat217'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '#.')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat217.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat218'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '#.')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat218.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat219'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '0.')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat219.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat220'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '0.')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat220.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat221'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, 'this.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat221.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "this.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat222'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, 'this.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat222.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "this1.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat223'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, 'this.0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat223.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "this.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat224'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, 'this.0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat224.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "this1.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat225'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '#.suffix')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat225.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0suffix") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat226'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '#.suffix')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat226.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1suffix") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat227'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '000.0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat227.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "000.2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat228'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0, '#.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat228.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat229'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0, '.#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat229.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat230'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(xs:integer(0), '###.###')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat230.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat231'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat231.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat232'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat232.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.1e1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat233'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat233.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "2e-1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat234'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat234.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat235'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '.#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat235.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat236'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '.#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat236.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".1e1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat237'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat237.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat238'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat238.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".1e1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat239'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '#.#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat239.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat240'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '#.#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat240.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.1e1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat241'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '0.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat241.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "2.0e-1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat242'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '0.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat242.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat243'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '0.#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat243.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "2e-1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat244'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '0.#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat244.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat245'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '#.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat245.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat246'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '#.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat246.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.1e1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat247'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '#.e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat247.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat248'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '#.e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat248.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.1e1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat249'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '0.e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat249.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "2e-1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat250'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, '0.e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat250.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat251'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, 'this.#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat251.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "this.2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat252'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, 'this.#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat252.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "this.1e1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat253'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, 'this.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat253.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "this.2e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat254'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(1.2, 'this.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat254.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "this.1e1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat255'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.2, '000.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat255.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "200.0e-3") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat261'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.002, '.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat261.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".2e-2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat262'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.002, '.000e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat262.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".200e-2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat263'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.002, '#.###e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat263.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.2e-2") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat301'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.99999999, '.#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat301.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.0e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat302'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.99999999, '.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat302.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.0e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat303'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.99999999, '#.#e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat303.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1e0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat304'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      fn:format-number(0.99999999, '0.0e0')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat304.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "10.0e-1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat310'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      format-number(642120, '####,##')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat310.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "6421,20") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat311'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      format-number(642120, '###,##')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat311.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "6421,20") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat312'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      format-number(642120, '##,##')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat312.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "64,21,20") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat313'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      format-number(642120, '#,##')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat313.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "64,21,20") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat314'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      format-number(642120, '0000,00')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat314.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "6421,20") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat315'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      format-number(642120, '000,00')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat315.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "6421,20") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat316'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      format-number(642120, '00,00')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat316.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "64,21,20") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat317'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      format-number(642120, '0,00')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat317.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "64,21,20") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat318'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      format-number(642120, '#,#,#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat318.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "6,4,2,1,2,0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat319'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "      format-number(642120, '##,#,#')\n"
        "    ",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformat319.xq"), Qry1),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "6421,2,0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat901err'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "\n"
        "        declare default decimal-format decimal-separator=\"!\" grouping-separator=\"!\";\n"
        "        format-number(931.4857,'###!###!###')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "numberformat901err.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "XQST0098") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: XQST0098 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat902err'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(931.4857,'000.##0')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "numberformat902err.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat905err'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(931.4857,'fred.ginger', 'q')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [
            {"q", [
                {'decimal-separator', "."},
                {'grouping-separator', ","}
            ]}
        ]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "numberformat905err.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1310") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1310 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat906InputErr'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number('abc','000.##0')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "numberformat906InputErr.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "XPTY0004") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: XPTY0004 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformat907InputErr'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(931.45, 931.45)",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "numberformat907InputErr.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "XPTY0004") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: XPTY0004 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformatFODF1280'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(931.45, '000.##0', 'foo:bar')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "numberformatFODF1280.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_error(Res, "FODF1280") of
            true -> {comment, "Correct error"};
            {true, F} -> {comment, "WE: FODF1280 " ++ binary_to_list(F)};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'numberformatNaN'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(number(\"abc\"),'#############')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(filename:join(__BaseDir, "numberformatNaN.xq"), Qry1),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "NaN") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-001'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(number(\"abc\"),'PREFIX#SUFFIX')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-001.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "NaN") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-002'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(0 div xs:double(\"INF\"), '#')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-002.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-003'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(0 div xs:double(\"-INF\"), '#')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', []},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-003.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-004'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1 div 0e0,'PREFIX#SUFFIX')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'infinity', "INF"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-004.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "PREFIXINFSUFFIX") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-005'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-1 div 0e0,'PREFIX#SUFFIX')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'infinity', "INF"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-005.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-PREFIXINFSUFFIX") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-006'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-1 div 0e0,'PREFIX#SUFFIX;prefix#suffix')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'infinity', "INF"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-006.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "prefixINFsuffix") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-007'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(-1 div 0e0,'PREFIX#SUFFIX;prefix#suffix')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'infinity', "INF"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-007.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "prefixINFsuffix") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-008'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(1e2,'#,000')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'infinity', "INF"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-008.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "100") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-009'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(100,'#,000')",
    {Env, Opts} = xqerl_test:handle_environment([
        {'decimal-formats', [{"", [{'infinity', "INF"}]}]},
        {sources, []},
        {collections, []},
        {'static-base-uri', []},
        {'context-item', [""]},
        {vars, []},
        {params, []},
        {namespaces, []},
        {schemas, []},
        {resources, []},
        {modules, []}
    ]),
    Qry1 = lists:flatten(Env ++ Qry),
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-009.xq"),
                Qry1
            ),
            xqerl:run(Mod, Opts)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "100") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-010'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0.9952832031249997'), '###,##0.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-010.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1.00") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-011'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('123456789'), '#,#')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-011.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1,2,3,4,5,6,7,8,9") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-012'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('123456789'), '#,##,00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-012.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1,23,45,67,89") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-013'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('123456789'), '##,##,00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-013.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1,23,45,67,89") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-014'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('123456789'), '#,##,##,00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-014.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1,23,45,67,89") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-015'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('123456789'), '###,##,00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-015.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12345,67,89") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-016'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('123456789'), '####,###,##,0')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-016.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "123,456,78,9") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-017'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('79228162514264337593543950335'), '0%')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-017.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case
            lists:any(
                fun
                    ({comment, _}) -> true;
                    (_) -> false
                end,
                [
                    case xqerl_test:assert_error(Res, "FOCA0001") of
                        true -> {comment, "Correct error"};
                        {true, F} -> {comment, "WE: FOCA0001 " ++ binary_to_list(F)};
                        {false, F} -> F
                    end,
                    case xqerl_test:assert_string_value(Res, "Infinity%") of
                        true -> {comment, "String correct"};
                        {false, F} -> F
                    end,
                    case xqerl_test:assert_string_value(Res, "7922816251426433759354395033500%") of
                        true -> {comment, "String correct"};
                        {false, F} -> F
                    end
                ]
            )
        of
            true -> {comment, "any-of"};
            _ -> false
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-018'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('0'), '.#')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-018.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-019'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('0'), '#.')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-019.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-020'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('0'), '.0')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-020.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-021'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('0'), '0.')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-021.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-022'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "format-number(xs:decimal('1.10203040506070809'), \n"
        "                                     '0.00000000000000000%')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-022.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "110.20304050607080900%") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-023'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('123456789'), '#,#')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-023.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1,2,3,4,5,6,7,8,9") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-024'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('123456789'), '#,##,00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-024.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1,23,45,67,89") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-025'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('123456789'), '##,##,00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-025.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1,23,45,67,89") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-026'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('123456789'), '#,##,##,00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-026.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "1,23,45,67,89") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-027'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('123456789'), '###,##,00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-027.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "12345,67,89") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-028'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('123456789'), '####,###,##,0')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-028.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "123,456,78,9") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-029'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('123456789'), '####,###,##,0')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-029.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "123,456,78,9") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-030'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0'), '.#')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-030.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-031'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0'), '#.')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-031.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-032'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0'), '.0')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-032.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-033'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0'), '0.')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-033.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-034'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('1e308'), '0%')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-034.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "Infinity%") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-035'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry =
        "substring-after(\n"
        "              format-number(xs:double('1.102030405060708090'),\n"
        "                                    '0.00000000000000000‰'),\n"
        "              format-number(xs:double('1.102030405060708090') * 1000, \n"
        "                                    '0.00000000000000000')) eq '‰'",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-035.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_true(Res) of
            true -> {comment, "Empty"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-036'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('-1e308'), '0%')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-036.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "-Infinity%") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-037'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('-79228162514264337593543950335'), '0%')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-037.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case
            lists:any(
                fun
                    ({comment, _}) -> true;
                    (_) -> false
                end,
                [
                    case xqerl_test:assert_error(Res, "FOCA0001") of
                        true -> {comment, "Correct error"};
                        {true, F} -> {comment, "WE: FOCA0001 " ++ binary_to_list(F)};
                        {false, F} -> F
                    end,
                    case xqerl_test:assert_string_value(Res, "-Infinity%") of
                        true -> {comment, "String correct"};
                        {false, F} -> F
                    end,
                    case xqerl_test:assert_string_value(Res, "-7922816251426433759354395033500%") of
                        true -> {comment, "String correct"};
                        {false, F} -> F
                    end
                ]
            )
        of
            true -> {comment, "any-of"};
            _ -> false
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-038'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0.1'), '0.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-038.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.10") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-039'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0.01'), '0.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-039.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.01") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-040'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0'), '#.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-040.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".00") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-041'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0'), '#.##')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-041.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-042'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0'), '0.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-042.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.00") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-043'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0.1'), '0.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-043.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.10") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-044'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0.01'), '0.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-044.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.01") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-045'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0.01'), '0.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-045.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.01") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-046'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0.01'), '0.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-046.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, "0.01") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-047'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0'), '#.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-047.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".00") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-048'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('0'), '#.00')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-048.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".00") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-049'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('0'), '###,###.##')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-049.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-050'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0'), '###,###.##')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-050.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".0") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-051'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:decimal('0.1'), '###,###.##')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-051.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.

'cbcl-fn-format-number-052'(Config) ->
    __BaseDir = ?config(base_dir, Config),
    Qry = "format-number(xs:double('0.1'), '###,###.##')",
    Qry1 = Qry,
    io:format("Qry1: ~p~n", [Qry1]),
    Res =
        try
            Mod = xqerl_code_server:compile(
                filename:join(__BaseDir, "cbcl-fn-format-number-052.xq"),
                Qry1
            ),
            xqerl:run(Mod)
        of
            D -> D
        catch
            _:E -> E
        end,
    Out =
        case xqerl_test:assert_string_value(Res, ".1") of
            true -> {comment, "String correct"};
            {false, F} -> F
        end,
    case Out of
        {comment, C} -> {comment, C};
        Err -> ct:fail(Err)
    end.
